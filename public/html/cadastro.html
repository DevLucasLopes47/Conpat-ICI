<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Patrimônios</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/css/cadastro.css">
    <link rel="icon" href="/imagens/ici-icon.ico" type="image/x-icon">
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Botão de Toggle -->
            <button class="toggle-btn" id="toggle-btn">
                <i class="fas fa-bars"></i>
            </button>

            <!-- Menu Lateral -->
            <nav id="sidebar">
                <img src="/imagens/compatbranca (1) (1).png" alt="Logo da Empresa" class="sidebar-logo">
                <ul>
                    <li><a href="index.html"><i class="fas fa-home"></i> Início</a></li>
                    <li><a href="saida.html"><i class="fas fa-minus-circle"></i> Saída de Equip.</a></li>
                    <li><a href="resultados.html"><i class="fas fa-eye"></i> Consulta</a></li>
                    <li><a href="dashboard.html"><i class="fas fa-chart-line"></i> Dashboard</a></li>
                    <li><a href="#"><i class="fas fa-cogs"></i> Configurações</a></li>
                    <li class="logout"><a href="tela.html"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                </ul>
            </nav>
        </div>
    </div>

    <div class="row">
        <div id="content" class="col-lg-10 col-md-9 col-sm-8">
            <div class="container mt-5">
                <h1 class="text-center">Entrada de Equipamentos</h1>
                <form id="patrimonioForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nometecnico">Nome do Técnico</label>
                            <input type="text" class="form-control" id="nometecnico" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="equipamento">Equipamento</label>
                            <select class="form-control" id="equipamento" required>
                                <option value="" disabled selected>Selecione</option>
                                <option value="Computador">Computador</option>
                                <option value="Monitor">Monitor</option>
                                <option value="Notebook">Notebook</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="chamadoici">Chamado ICI</label>
                            <input type="text" class="form-control" id="chamadoici" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="acao">Ação</label>
                            <select class="form-control" id="acao" required>
                                <option value="" disabled selected>Selecione</option>
                                <option value="Formatação">Formatação</option>
                                <option value="Limpeza da Máquina">Limpeza da Máquina</option>
                                <option value="Testes">Testes</option>
                                <option value="Verificação TI-PMNL">Verificação pela TI-PMNL</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="Data-Entrada">Data de Entrada</label>
                            <input type="date" class="form-control" id="Data-Entrada" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="patrimonio">Patrimônio</label>
                            <input type="text" class="form-control" id="patrimonio" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="local">Local do Equipamento</label>
                            <input type="text" class="form-control" id="local" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary" id="submitBtn">Cadastrar</button>
                </form>
            </div>
        </div>
    </div>
            <script>
                document.getElementById('patrimonioForm').addEventListener('submit', function (event) {
                    event.preventDefault();

                    const nometecnico = document.getElementById('nometecnico').value;
                    const equipamento = document.getElementById('equipamento').value;
                    const chamadoici = document.getElementById('chamadoici').value;
                    const acao = document.getElementById('acao').value;
                    const dataEntrada = document.getElementById('Data-Entrada').value;
                    const patrimonio = document.getElementById('patrimonio').value;
                    const local = document.getElementById('local').value;

                    if (!nometecnico || !equipamento || !chamadoici || !acao || !dataEntrada || !patrimonio || !local) {
                        alert('Por favor, preencha todos os campos obrigatórios.');
                        return;
                    }

                    const patrimonioData = {
                        nometecnico,
                        equipamento,
                        chamadoici,
                        acao,
                        dataEntrada,
                        patrimonio,
                        local,
                        dataSaida: null
                    };

                    fetch('/api/patrimonios', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(patrimonioData)
                    })
                        .then(response => response.json())
                        .then(data => {
                            alert(data.message || 'Patrimônio cadastrado com sucesso!');
                            document.getElementById('patrimonioForm').reset();
                        })
                        .catch(error => {
                            console.error('Erro:', error);
                            alert('Erro ao cadastrar patrimônio. Tente novamente.');
                        });
                });
            </script>
        </div>
    </div>
</body>

</html>
